<div class="page-wrapper">
    <div class="content">
      <div class="container-fluid p-4">
  
        <!-- LOADER -->
        <ng-container *ngIf="!loading; else cargando">
          
          <!-- NAV TABS -->
          <ul class="nav nav-tabs mb-4 border-bottom patient-tabs">
            <li class="nav-item">
              <a [routerLink]="['/pacientes/detalle', idPaciente, 'perfil']"
                 routerLinkActive="active-tab"
                 [routerLinkActiveOptions]="{ exact: true }"
                 class="nav-link">PERFIL</a>
            </li>
            <li class="nav-item">
              <a [routerLink]="['/pacientes/detalle', idPaciente, 'curso-clinico']"
                 routerLinkActive="active-tab"
                 class="nav-link">CURSO CLÍNICO</a>
            </li>
            <li class="nav-item">
              <a [routerLink]="['/pacientes/detalle', idPaciente, 'consulta-actual']"
                 routerLinkActive="active-tab"
                 class="nav-link">CONSULTA ACTUAL</a>
            </li>
            <li class="nav-item">
              <a [routerLink]="['/pacientes/detalle', idPaciente, 'telemetria']"
                 routerLinkActive="active-tab"
                 class="nav-link">TELEMETRÍA</a>
            </li>
            <li class="nav-item">
              <a [routerLink]="['/pacientes/detalle', idPaciente, 'cuestionarios']"
                 routerLinkActive="active-tab"
                 class="nav-link">CUESTIONARIOS</a>
            </li>
          </ul>
  
          <!-- FICHA DEL PACIENTE -->
          <div *ngIf="patientDetails" class="patient-summary">
            <div class="row gy-3 align-items-stretch">
              <!-- Columna 1 -->
              <div class="col-lg-4 col-md-12">
                <div class="h-100 d-flex flex-column justify-content-between">
                  <div class="fw-bold text-uppercase text-secondary small">
                    EXPEDIENTE <span class="text-info">#{{ patientDetails.numeroExpediente }}</span>
                  </div>
                  <h4 class="fw-bold text-uppercase text-dark mb-2">
                    {{ patientDetails.nombre }} {{ patientDetails.apellidoPaterno }} {{ patientDetails.apellidoMaterno }}
                  </h4>
                  <p class="text-muted small mb-2">
                    <strong>FECHA DE NACIMIENTO:</strong> {{ patientDetails.fechaNacimiento | date: 'dd MMMM yyyy' }}
                  </p>
                  <div class="d-flex flex-wrap gap-3 text-muted small">
                    <div><strong class="text-info">EDAD:</strong> {{ patientAge }} AÑOS</div>
                    <div><strong class="text-info">SEXO:</strong> {{ patientDetails.sexo }}</div>
                    <div><strong class="text-info">ESTADO CIVIL:</strong> {{ patientDetails.estadoCivil || '-' }}</div>
                    <div><strong class="text-info">RELIGIÓN:</strong> {{ patientDetails.religion || '-' }}</div>
                  </div>
                </div>
              </div>
  
              <!-- Columna 2 -->
              <div class="col-lg-4 col-md-6">
                <div class="info-box h-100">
                  <div class="mb-2 fw-bold text-danger"><i class="fas fa-exclamation-triangle me-1"></i> ALERGIAS</div>
                  <div class="mb-1"><strong class="text-muted">Alergias:</strong> {{ patientDetails.alergias || 'NINGUNA' }}</div>
                  <div class="mb-1"><strong class="text-muted">Tipo de Sangre:</strong> {{ patientDetails.tipoSangre || '-' }}</div>
                  <div class="mb-1"><strong class="text-muted">Derechohabiencia:</strong> {{ patientDetails.afiliacion || '-' }}</div>
                  <div class="mb-1"><strong class="text-muted">No. de Afiliación:</strong> {{ patientDetails.numeroAfiliacion || '-' }}</div>
                </div>
              </div>
  
              <!-- Columna 3 -->
              <div *ngIf="tutor !== true" class="col-lg-4 col-md-6">
                <div class="info-box h-100">
                  <div class="mb-2 fw-bold text-danger"><i class="fas fa-user-friends me-1"></i> DATOS DEL TUTOR</div>
                  <div class="mb-1"><strong class="text-muted">Nombre:</strong> {{ nombr }}</div>
                  <div class="mb-1"><strong class="text-muted">Parentesco:</strong> {{ paren }}</div>
                  <div class="mb-1"><strong class="text-muted">Teléfono:</strong> {{ telef }}</div>
                  <div class="mb-1"><strong class="text-muted">Email:</strong> {{ email }}</div>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Cuerpo dinámico -->
          <router-outlet></router-outlet>
  
        </ng-container>
  
        <!-- TEMPLATE LOADER -->
        <ng-template #cargando>
          <div class="text-center py-5">
            <div class="spinner-border text-info" role="status"></div>
            <p class="mt-3 text-muted">Cargando expediente del paciente...</p>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
  